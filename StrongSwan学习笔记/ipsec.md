







# 1. 封装安全载荷 (ESP)





## 1.1. IPsec 传输模式





## 1.2. IPsec 隧道模式





## 1.3. ESP 数据包结构





# 2. 互联网密钥交换协议版本2 (IKEv2)



## 2.1. IKE_SA_INIT 请求 / 响应







## 2.2. IKE_AUTH 请求 / 响应





### 2.2.1. 基于证书的认证



### 2.2.2. 基于预共享密钥（PSK）的认证



### 2.2.3. 基于可扩展认证协议（EAP）的认证



## 2.3. CREATE_CHILD_SA 请求 / 响应







# 3. NAT 穿透





## 3.1. ESP-over-UDP 封装





## 3.2. 非 ESP 标记





## 3.3. NAT-T 保活机制











